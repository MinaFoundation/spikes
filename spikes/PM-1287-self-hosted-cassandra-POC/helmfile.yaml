---
repositories:
  - name: bitnami
    url: registry-1.docker.io/bitnamicharts
    oci: true

environments:
  default:
    values:
      - database:
          host: production-mainnet-archive.c14zvdudnyw7.us-west-2.rds.amazonaws.com
          username: ref+awssecrets://production/mainnet/archive?region=us-west-2#/username
          password: ref+awssecrets://production/mainnet/archive?region=us-west-2#/password
          database: archive_balances_migrated
      - testnet:
          name: berkeley
          platform: staging
          cassandraName: uptime-service-cassandra
---
releases:
- name: {{ .Values.testnet.cassandraName }}
  namespace: {{ .Values.testnet.name }}
  chart: bitnami/cassandra
  version: 10.11.2
  values:
    - tls:
        clientEncryption: true
        autoGenerated: true
    - initDBConfigMap: uptime-service-cassandra-initdb
    - dbUser:
        password: aaaa
    - replicaCount: 3
    - persistence:
        storageClass: ebs-gp3-encrypted
    - jvm:
        maxHeapSize: 4G
        newHeapSize: 1G
    - resources:
        limits:
          cpu: 2
          memory: 12Gi
        requests:
          cpu: 1
          memory: 10Gi
    - podAnnotations:
        karpenter.sh/do-not-evict: "true"
